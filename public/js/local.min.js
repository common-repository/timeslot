jQuery(function(){const{__}=wp.i18n;jQuery("#ts-btn-submit").on("click",function(e){e.preventDefault();jQuery(".ts-dot-wrapper").show();jQuery(".ts-summary").css("filter","blur(2px)");jQuery("#ts-btn-prev,#ts-btn-submit").hide();var date=jQuery("#ts-format-date").val();var time=jQuery("#ts-select-time").val();var fullstart=date+"T"+time;let staff=jQuery("#ts-select-staff")?jQuery("#ts-select-staff").val():"";let apptFormData=[["action","tslot_install_data"],["service",jQuery(".ts-service").val()],["staff",staff],["date",date],["time",time],["start",fullstart],["name",jQuery("#ts-input-name").val()],["email",jQuery("#ts-input-email").val()],["phone",jQuery("#ts-input-phone").val()],["source",__("Local","timeslot")],["coupon",jQuery("#ts-input-coupon").length?jQuery("#ts-input-coupon").val():""],["capture_id","None"],["nonce",jQuery("#ts_form_nonce").val()]];const apptform=new FormData;apptFormData.forEach(data=>{apptform.append(data[0],data[1])});fetch(tsao.ajaxurl,{method:"POST",credentials:"same-origin",body:apptform}).then(response=>{if(response.ok){return}else{Promise.reject(__("Local Payment Fetch Error","timeslot"));throw new Error(__("Local Payment Fetch Error","timeslot"))}}).then(function(){jQuery(".ts-summary").css("filter","blur(0)");jQuery(".ts-dot-wrapper").hide();jQuery(".ts-success-msg").show()}).then(function(){apptform.set("action","tslot_appt_email");fetch(tsao.ajaxurl,{method:"POST",credentials:"same-origin",body:apptform})}).then(function(){jQuery(".ts-form")[0].reset()}).catch(function(){error=>console.error(__("Local Payment Network Error: ","timeslot"),+error.message);jQuery(".ts-error-msg").show();jQuery(".ts-summary").css("filter","blur(0)");jQuery(".ts-dot-wrapper").hide()})})});